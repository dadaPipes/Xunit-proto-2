<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class VstsReporter | xunit </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class VstsReporter | xunit ">
      
      <meta name="description" content="An implementation of  that reports results to Azure DevOps/VSTS. This is auto-enabled by the presence of four required environment variables: &amp;quot;VSTS_ACCESS_TOKEN&amp;quot;, &amp;quot;SYSTEM_TEAMFOUNDATIONCOLLECTIONURI&amp;quot;, &amp;quot;SYSTEM_TEAMPROJECT&amp;quot;, and &amp;quot;BUILD_BUILDID&amp;quot;.">
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/xunit/xunit/new/229879b7653ec0573f36ca4759ccfc915be11a21/apiSpec/new?filename=Xunit_Runner_Common_VstsReporter.md&amp;value=---%0Auid%3A%20Xunit.Runner.Common.VstsReporter%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="xunit">
            xunit
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Xunit.Runner.Common.VstsReporter">



  <h1 id="Xunit_Runner_Common_VstsReporter" data-uid="Xunit.Runner.Common.VstsReporter" class="text-break">
Class VstsReporter  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L14"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Xunit.html">Xunit</a>.<a class="xref" href="Xunit.Runner.html">Runner</a>.<a class="xref" href="Xunit.Runner.Common.html">Common</a></dd></dl>
  <dl><dt>Assembly</dt><dd>xunit.v3.runner.common.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>An implementation of <a class="xref" href="Xunit.Runner.Common.IRunnerReporter.html">IRunnerReporter</a> that reports results to Azure DevOps/VSTS.
This is auto-enabled by the presence of four required environment variables: &quot;VSTS_ACCESS_TOKEN&quot;,
&quot;SYSTEM_TEAMFOUNDATIONCOLLECTIONURI&quot;, &quot;SYSTEM_TEAMPROJECT&quot;, and &quot;BUILD_BUILDID&quot;.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class VstsReporter : IRunnerReporter</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">VstsReporter</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="Xunit.Runner.Common.IRunnerReporter.html">IRunnerReporter</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>

  <dl class="typelist extensionMethods">
    <dt>Extension Methods</dt>
    <dd>
  <div>
      <a class="xref" href="Xunit.Internal.ObjectExtensions.html#Xunit_Internal_ObjectExtensions_AsValueTask_System_Object_">ObjectExtensions.AsValueTask(object?)</a>
  </div>
  <div>
      <a class="xref" href="Xunit.Internal.ObjectExtensions.html#Xunit_Internal_ObjectExtensions_ValidateNullablePropertyValue__1_System_Object_System_Nullable___0__System_String_">ObjectExtensions.ValidateNullablePropertyValue&lt;T&gt;(object, T?, string)</a>
  </div>
  <div>
      <a class="xref" href="Xunit.Internal.ObjectExtensions.html#Xunit_Internal_ObjectExtensions_ValidateNullablePropertyValue__1_System_Object___0_System_String_">ObjectExtensions.ValidateNullablePropertyValue&lt;T&gt;(object, T?, string)</a>
  </div>
  </dd></dl>





  <h2 class="section" id="properties">Properties
</h2>


  <a id="Xunit_Runner_Common_VstsReporter_CanBeEnvironmentallyEnabled_" data-uid="Xunit.Runner.Common.VstsReporter.CanBeEnvironmentallyEnabled*"></a>

  <h3 id="Xunit_Runner_Common_VstsReporter_CanBeEnvironmentallyEnabled" data-uid="Xunit.Runner.Common.VstsReporter.CanBeEnvironmentallyEnabled">
  CanBeEnvironmentallyEnabled
  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L17"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets a value which indicates if it's possible for this reporter to be environmentally
enabled.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool CanBeEnvironmentallyEnabled { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="Xunit_Runner_Common_VstsReporter_CanBeEnvironmentallyEnabled_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Note that this differs from <a class="xref" href="Xunit.Runner.Common.IRunnerReporter.html#Xunit_Runner_Common_IRunnerReporter_IsEnvironmentallyEnabled">IsEnvironmentallyEnabled</a> which checks to see whether
the conditions currently exist to environmentally enable the reporter. This value is used when
constructing the console runner help output that lists which runners might be environmentally
enabled.</p>
</div>




  <a id="Xunit_Runner_Common_VstsReporter_Description_" data-uid="Xunit.Runner.Common.VstsReporter.Description*"></a>

  <h3 id="Xunit_Runner_Common_VstsReporter_Description" data-uid="Xunit.Runner.Common.VstsReporter.Description">
  Description
  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L21"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets the description of the reporter. This is typically used when showing
the user the invocation option for the reporter.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string Description { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
  </dl>








  <a id="Xunit_Runner_Common_VstsReporter_ForceNoLogo_" data-uid="Xunit.Runner.Common.VstsReporter.ForceNoLogo*"></a>

  <h3 id="Xunit_Runner_Common_VstsReporter_ForceNoLogo" data-uid="Xunit.Runner.Common.VstsReporter.ForceNoLogo">
  ForceNoLogo
  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L25"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets a value which indicates whether this runner wishes to force no logo.
Useful for runners which are designed for purely parseable output
(for example, <a class="xref" href="Xunit.Runner.Common.JsonReporter.html">JsonReporter</a>).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool ForceNoLogo { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>








  <a id="Xunit_Runner_Common_VstsReporter_IsEnvironmentallyEnabled_" data-uid="Xunit.Runner.Common.VstsReporter.IsEnvironmentallyEnabled*"></a>

  <h3 id="Xunit_Runner_Common_VstsReporter_IsEnvironmentallyEnabled" data-uid="Xunit.Runner.Common.VstsReporter.IsEnvironmentallyEnabled">
  IsEnvironmentallyEnabled
  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L29"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets a value which indicates whether the reporter should be
environmentally enabled.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool IsEnvironmentallyEnabled { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="Xunit_Runner_Common_VstsReporter_IsEnvironmentallyEnabled_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>When a runner reporter is environmentally enabled in Microsoft Testing Platform
CLI mode (or <code>dotnet test</code>), by default all realtime output is filtered except
calls to <a class="xref" href="Xunit.Runner.Common.IRunnerLogger.html#Xunit_Runner_Common_IRunnerLogger_LogRaw_System_String_">LogRaw(string)</a> (unless the user has specified the
<code>--xunit-info</code> switch). Environmentally enabled reporters that require
realtime console output (for example, to send formatted messages to a CI system
which parses the console output) must use <a class="xref" href="Xunit.Runner.Common.IRunnerLogger.html#Xunit_Runner_Common_IRunnerLogger_LogRaw_System_String_">LogRaw(string)</a> to
ensure those messages will always be visible. All other messages will always be
output to the Microsoft Testing Platform diagnostic logs, which are enabled via
the <code>--diagnostic</code> switch.</p>
</div>




  <a id="Xunit_Runner_Common_VstsReporter_RunnerSwitch_" data-uid="Xunit.Runner.Common.VstsReporter.RunnerSwitch*"></a>

  <h3 id="Xunit_Runner_Common_VstsReporter_RunnerSwitch" data-uid="Xunit.Runner.Common.VstsReporter.RunnerSwitch">
  RunnerSwitch
  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L36"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Gets a value which indicates a runner switch which can be used
to explicitly enable the runner. If the return value is <code>null</code>,
then the reported can only be environmentally enabled (implicitly).
This value is used either as a command line switch (with the console or
.NET CLI runner) or as a runner configuration value (with the MSBuild runner).</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string? RunnerSwitch { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="Xunit_Runner_Common_VstsReporter_RunnerSwitch_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Runner switches are only used in xUnit.net native CLI mode. When Microsoft
Testing Platform CLI mode is enabled, reporters are only supported via environmental
enablement, since MTP generally controls all the normal output.</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="Xunit_Runner_Common_VstsReporter_CreateMessageHandler_" data-uid="Xunit.Runner.Common.VstsReporter.CreateMessageHandler*"></a>

  <h3 id="Xunit_Runner_Common_VstsReporter_CreateMessageHandler_Xunit_Runner_Common_IRunnerLogger_Xunit_Sdk_IMessageSink_" data-uid="Xunit.Runner.Common.VstsReporter.CreateMessageHandler(Xunit.Runner.Common.IRunnerLogger,Xunit.Sdk.IMessageSink)">
  CreateMessageHandler(IRunnerLogger, IMessageSink?)
  <a class="header-action link-secondary" title="View source" href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L40"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Creates a message handler that will report messages for the given
test assembly.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ValueTask&lt;IRunnerReporterMessageHandler&gt; CreateMessageHandler(IRunnerLogger logger, IMessageSink? diagnosticMessageSink)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>logger</code> <a class="xref" href="Xunit.Runner.Common.IRunnerLogger.html">IRunnerLogger</a></dt>
    <dd><p>The logger used to send result messages to</p>
</dd>
    <dt><code>diagnosticMessageSink</code> <a class="xref" href="Xunit.Sdk.IMessageSink.html">IMessageSink</a></dt>
    <dd><p>An optional message sink that diagnostic messages can be sent to.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.valuetask-1">ValueTask</a>&lt;<a class="xref" href="Xunit.Runner.Common.IRunnerReporterMessageHandler.html">IRunnerReporterMessageHandler</a>&gt;</dt>
    <dd><p>The message handler that handles the messages</p>
</dd>
  </dl>












</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/xunit/xunit/blob/229879b7653ec0573f36ca4759ccfc915be11a21/src/xunit.v3.runner.common/Reporters/Builtin/VstsReporter.cs/#L14" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
